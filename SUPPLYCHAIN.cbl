       IDENTIFICATION DIVISION.
       PROGRAM-ID. SUPPLY-CHAIN-MANAGEMENT.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT SUPPLY-CHAIN-FILE ASSIGN TO "SUPPLYCHAIN.DAT"
               ORGANIZATION IS INDEXED
               ACCESS MODE IS DYNAMIC
               RECORD KEY IS ITEM-ID
               FILE STATUS IS FS-SUPPLY-CHAIN.

       DATA DIVISION.
       FILE SECTION.

       FD SUPPLY-CHAIN-FILE.
       01 SUPPLY-CHAIN-RECORD-DATA.
           COPY SUPPLY-CHAIN-RECORD.

       WORKING-STORAGE SECTION.
       01 FS-SUPPLY-CHAIN      PIC XX.
       01 WS-TIME-STAMP.
           05 WS-DATE           PIC 9(8) YYYYMMDD.
           05 WS-TIME           PIC 9(6) HHMMSS.

       01 WS-SUPPLY-CHAIN-RECORD.
           COPY SUPPLY-CHAIN-RECORD.

       PROCEDURE DIVISION.

       OPEN-FILES.
           OPEN I-O SUPPLY-CHAIN-FILE.
           PERFORM FILE-STATUS-CHECK.

       CLOSE-FILES.
           CLOSE SUPPLY-CHAIN-FILE.

       FILE-STATUS-CHECK.
           IF FS-SUPPLY-CHAIN NOT = "00"
               DISPLAY "ERROR IN SUPPLY-CHAIN-FILE: " FS-SUPPLY-CHAIN
           END-IF.

       ADD-SUPPLY-CHAIN-RECORD.
           MOVE ITEM-ID TO WS-ITEM-ID
           MOVE ITEM-DESCRIPTION TO WS-ITEM-DESCRIPTION
           MOVE ITEM-QUANTITY TO WS-ITEM-QUANTITY
           MOVE SUPPLIER-ID TO WS-SUPPLIER-ID
           MOVE SUPPLIER-NAME TO WS-SUPPLIER-NAME
           MOVE SHIPMENT-ID TO WS-SHIPMENT-ID
           MOVE SHIPMENT-DATE TO WS-SHIPMENT-DATE
           MOVE RECEIVED-DATE TO WS-RECEIVED-DATE
           MOVE TRANSACTION-ID TO WS-TRANSACTION-ID
           MOVE TRANSACTION-AMOUNT TO WS-TRANSACTION-AMOUNT
           MOVE TRANSACTION-STATUS TO WS-TRANSACTION-STATUS
           ACCEPT WS-TIME-STAMP FROM TIME
           MOVE WS-TIME-STAMP TO WS-AUDIT-TIMESTAMP
           WRITE SUPPLY-CHAIN-RECORD-DATA FROM WS-SUPPLY-CHAIN-RECORD
           PERFORM FILE-STATUS-CHECK.

       UPDATE-SUPPLY-CHAIN-RECORD.
           MOVE ITEM-ID TO WS-ITEM-ID
           START SUPPLY-CHAIN-FILE KEY IS EQUAL TO WS-ITEM-ID
           READ SUPPLY-CHAIN-FILE NEXT RECORD
           AT END DISPLAY "ITEM-ID NOT FOUND".
           MOVE ITEM-DESCRIPTION TO WS-ITEM-DESCRIPTION
           MOVE ITEM-QUANTITY TO WS-ITEM-QUANTITY
           MOVE SUPPLIER-ID TO WS-SUPPLIER-ID
           MOVE SUPPLIER-NAME TO WS-SUPPLIER-NAME
           MOVE SHIPMENT-ID TO WS-SHIPMENT-ID
           MOVE SHIPMENT-DATE TO WS-SHIPMENT-DATE
           MOVE RECEIVED-DATE TO WS-RECEIVED-DATE
           MOVE TRANSACTION-ID TO WS-TRANSACTION-ID
           MOVE TRANSACTION-AMOUNT TO WS-TRANSACTION-AMOUNT
           MOVE TRANSACTION-STATUS TO WS-TRANSACTION-STATUS
           ACCEPT WS-TIME-STAMP FROM TIME
           MOVE WS-TIME-STAMP TO WS-AUDIT-TIMESTAMP
           REWRITE SUPPLY-CHAIN-RECORD-DATA FROM WS-SUPPLY-CHAIN-RECORD
           PERFORM FILE-STATUS-CHECK.

       DELETE-SUPPLY-CHAIN-RECORD.
           MOVE ITEM-ID TO WS-ITEM-ID
           START SUPPLY-CHAIN-FILE KEY IS EQUAL TO WS-ITEM-ID
           READ SUPPLY-CHAIN-FILE NEXT RECORD
           AT END DISPLAY "ITEM-ID NOT FOUND".
           DELETE SUPPLY-CHAIN-FILE RECORD
           PERFORM FILE-STATUS-CHECK.

       END PROGRAM SUPPLY-CHAIN-MANAGEMENT.
